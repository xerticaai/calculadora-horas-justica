<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Impacto de IA na Justiça | Xertica.ai</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Material Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
    <!-- html2canvas Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" xintegrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibVocXFl+enL3ZeaNgGiDRUg3iGlrzkw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style>
        :root {
            --brand-primary: #00C0FF;
            --brand-accent: #FF00F3;
            --text-strong: #1E1E1E;
            --text-muted: #393232;
            --text-light: #F0F0F0;
            --bg-page: #ffffff;
            --bg-soft: #F6F8FA;
            --bg-hero: #F9F8FF;
            --bg-dark: #121212;
            --stroke: #E6E8EB;
            --font-heading: 'Space Mono', monospace;
            --font-body: 'Roboto', sans-serif;
            --space-xs: clamp(0.5rem, 1vw, 0.75rem);
            --space-sm: clamp(1rem, 2vw, 1.25rem);
            --space-md: clamp(1.5rem, 3vw, 2rem);
            --space-lg: clamp(2.5rem, 5vw, 4rem);
            --space-xl: clamp(4rem, 8vw, 6rem);
            --border-radius-sm: 8px;
            --border-radius-md: 16px;
            --transition-fast: 0.3s ease-out;
            --container-width: 900px;
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }

        body {
            font-family: var(--font-body);
            background-color: var(--bg-hero);
            background-image: 
                radial-gradient(circle at 100% 0%, rgba(255, 0, 243, 0.1), transparent 40%),
                radial-gradient(circle at 0% 100%, rgba(0, 192, 255, 0.1), transparent 40%),
                repeating-linear-gradient(rgba(240, 238, 252, 0.5) 0, rgba(240, 238, 252, 0.5) 1px, transparent 1px, transparent 50px),
                repeating-linear-gradient(to right, rgba(240, 238, 252, 0.5) 0, rgba(240, 238, 252, 0.5) 1px, transparent 1px, transparent 50px);
            color: var(--text-muted);
            line-height: 1.7;
            -webkit-font-smoothing: antialiased;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        main {
            flex-grow: 1;
            display: flex;
            align-items: flex-start; /* Alinha card ao topo */
            justify-content: center;
            padding: var(--space-md) var(--space-md) var(--space-xl) var(--space-md);
        }

        h1, h2, h3, h4 {
            font-family: var(--font-heading);
            color: var(--text-strong);
            font-weight: 700;
            text-transform: uppercase;
        }

        .container { width: 100%; max-width: var(--container-width); margin: 0 auto; }
        
        .site-header {
            padding: var(--space-sm) 0; /* Espaçamento vertical reduzido */
            width: 100%;
            display: flex; 
            align-items: center; 
            justify-content: center; 
        }
        .header-container {
             width: 100%; max-width: 1120px; margin: 0 auto; padding: 0 var(--space-md); 
             display: flex; 
             align-items: center; 
             justify-content: center; 
        }
        .logo { /* position: relative; top: 2px; */ } /* REMOVIDO o ajuste anterior */
        .logo img { 
            height: 30px; 
            display: block; 
            transform: translateY(3px); /* MODIFICADO: Usando transform para ajuste fino */
        } 

        .calculator-card {
            background-color: var(--bg-page);
            border-radius: var(--border-radius-md);
            padding: var(--space-lg);
            border: 1px solid var(--stroke);
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .calculator-card h1 {
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            line-height: 1.2;
            margin-bottom: var(--space-xs);
        }

        .calculator-card .subtitle {
            font-size: clamp(1rem, 1.5vw, 1.1rem);
            max-width: 60ch;
            margin: 0 auto var(--space-lg) auto;
        }
        
        .form-title {
            font-family: var(--font-heading);
            font-size: 1rem;
            text-transform: uppercase;
            color: var(--text-muted);
            margin-bottom: var(--space-lg);
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
            text-align: left;
        }
        .input-group {
            position: relative;
        }
        .input-group label {
            font-weight: 700;
            font-size: 0.9rem;
            display: block;
            margin-bottom: var(--space-xs);
        }
        .input-group input {
            width: 100%;
            padding: 0.8rem 1rem;
            border-radius: var(--border-radius-sm);
            border: 2px solid var(--stroke);
            font-size: 1rem;
            transition: border-color var(--transition-fast);
        }
        .input-group input:focus {
            outline: none;
            border-color: var(--brand-primary);
        }

        .btn-calculate {
            display: inline-block;
            padding: 1rem 2.5rem;
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: clamp(0.9rem, 1.2vw, 1rem);
            text-transform: uppercase;
            border-radius: 50px;
            text-decoration: none;
            color: white;
            background: linear-gradient(90deg, var(--brand-primary), var(--brand-accent));
            background-size: 200% auto;
            border: none;
            transition: all var(--transition-fast);
            cursor: pointer;
        }
        .btn-calculate:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0, 192, 255, 0.5);
            background-position: right center;
        }

        #results-section {
            display: none;
            opacity: 0;
            transition: opacity 0.6s ease-out;
            margin-top: var(--space-xl);
            padding-top: var(--space-xl);
            border-top: 1px solid var(--stroke);
        }
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--space-md);
        }
        
        .btn-export {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            padding: 0.6rem 1.2rem;
            font-family: var(--font-body);
            font-weight: 700;
            font-size: 0.9rem;
            border-radius: 50px;
            border: 1px solid var(--stroke);
            background-color: var(--bg-soft);
            color: var(--text-muted);
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        .btn-export:hover {
            background-color: var(--stroke);
            color: var(--text-strong);
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-top: var(--space-md);
            margin-bottom: var(--space-xl);
        }
        .result-item {
            background-color: var(--bg-soft);
            padding: var(--space-md);
            border-radius: var(--border-radius-sm);
        }
        .result-item .value {
            font-family: var(--font-heading);
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            line-height: 1;
            font-weight: 700;
            text-transform: uppercase;
            background: linear-gradient(90deg, var(--brand-accent), var(--brand-primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .result-item .label {
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            display: block;
            margin-bottom: var(--space-xs);
        }
        .result-item .description {
            font-size: 0.85rem;
            line-height: 1.5;
            color: var(--text-muted);
        }
        
        .capacity-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--space-md);
            font-size: 1rem;
            box-shadow: var(--shadow-md);
            border-radius: var(--border-radius-sm);
            overflow: hidden;
            text-align: left;
        }
        .capacity-table th, .capacity-table td {
            padding: var(--space-md);
        }
        .capacity-table thead tr {
            background: linear-gradient(135deg, var(--brand-primary), var(--brand-accent));
            color: white;
            text-transform: uppercase;
            font-family: var(--font-heading);
            font-size: 0.9rem;
        }
        .capacity-table tbody tr {
            border-bottom: 1px solid var(--stroke);
        }
        .capacity-table tbody tr:nth-of-type(even) {
            background-color: var(--bg-soft);
        }
        .capacity-table .new-capacity {
            font-weight: 700;
            color: var(--brand-primary);
        }

        .rules-container {
            margin-top: var(--space-xl);
            text-align: center;
        }
        #rules-toggle {
            background: none;
            border: none;
            color: var(--text-muted);
            font-weight: 700;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            font-size: 0.9rem;
        }
        #rules-toggle .material-symbols-outlined {
            transition: transform var(--transition-fast);
        }
        #rules-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
            text-align: left;
            background-color: var(--bg-soft);
            border-radius: var(--border-radius-sm);
            padding: 0 var(--space-md);
            margin-top: var(--space-md);
            font-size: 0.9rem;
            line-height: 1.8;
        }
        #rules-content.visible {
            max-height: 2000px; /* Adjust if content is longer */
            padding: var(--space-md);
        }
        #rules-content h4 { font-size: 1rem; margin-top: var(--space-md); margin-bottom: var(--space-xs); color: var(--text-strong); text-transform: uppercase; }
        #rules-content ul { list-style-position: inside; padding-left: 0; }
        
        .rules-header-flex { 
            display: flex;
            justify-content: center;
            align-items: center;
            gap: var(--space-md);
            flex-wrap: wrap;
        }

        .disclaimer-text { 
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: var(--space-md);
            border-top: 1px solid var(--stroke);
            padding-top: var(--space-md);
            text-align: left;
            line-height: 1.5;
        }

        .site-footer {
             padding: var(--space-sm) 0; /* Espaçamento vertical reduzido */
             text-align: center;
             font-size: 0.9rem;
             color: var(--text-muted);
             margin-top: auto; /* Empurra rodapé para baixo */
             
             /* MODIFICADO: Adicionado flex para centralização vertical perfeita */
             display: flex;
             justify-content: center;
             align-items: center;
        }
        .site-footer p {
            line-height: 1; /* Garante que o texto não tenha espaçamento de linha extra */
            margin: 0; /* NOVO: Garante que não há margem */
        }

        /* Styles for Image rendering element */
        #render-container {
            position: absolute;
            left: -9999px; /* Position off-screen */
            top: 0;
            background: white;
            z-index: -1;
        }
    </style>
</head>
<body>

    <header class="site-header">
        <div class="header-container">
            <a href="#" class="logo"><img src="https://cdn.prod.website-files.com/653ff55cffa885d43e1a7bfa/6672e8383dbaa6bd3e8e527c_logo-xerticaAi.png" alt="Logo Xertica.ai"></a>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="calculator-card">
                <h1>Calcule o Potencial de Economia de Horas na Justiça com IA</h1>
                <p class="subtitle">Insira os volumes mensais de tarefas da sua equipe para quantificar o ganho de eficiência e a economia de tempo que a Inteligência Artificial pode gerar.</p>

                <div id="calculator-inputs">
                     <div class="input-grid" style="gap: var(--space-md);">
                        <div class="input-group">
                            <label for="client_name">Nome do Cliente</label>
                            <input type="text" id="client_name" placeholder="Ex: João Silva">
                        </div>
                        <div class="input-group">
                            <label for="client_company">Órgão / Empresa do Cliente</label>
                            <input type="text" id="client_company" placeholder="Ex: TJSP">
                        </div>
                         <div class="input-group">
                            <label for="seller_name">Consultor Xertica.ai</label>
                            <input type="text" id="seller_name" placeholder="Seu nome">
                        </div>
                    </div>

                    <h2 class="form-title">Volume Mensal de Tarefas</h2>
                    <div class="input-grid">
                        <div class="input-group">
                            <label for="transcricoes">Horas de vídeos para transcrição por mês</label>
                            <input type="number" id="transcricoes" placeholder="Ex: 50" min="0">
                        </div>
                        <div class="input-group">
                            <label for="documentos">Documentos elaborados por mês</label>
                            <input type="number" id="documentos" placeholder="Ex: 200" min="0">
                        </div>
                        <div class="input-group">
                            <label for="pesquisas">Pesquisas de jurisprudência por mês</label>
                            <input type="number" id="pesquisas" placeholder="Ex: 100" min="0">
                        </div>
                         <div class="input-group">
                            <label for="atendimentos">Atendimentos ao cidadão por mês</label>
                            <input type="number" id="atendimentos" placeholder="Ex: 1000" min="0">
                        </div>
                    </div>
                    <button id="calculate-btn" class="btn-calculate">Gerar Relatório de Impacto</button>
                </div>

                <div id="results-section">
                    <div class="results-header">
                        <h2 id="results-title">Relatório de Impacto com IA</h2>
                        <div class="export-buttons">
                            <button id="save-png-btn" class="btn-export">
                                <span class="material-symbols-outlined">image</span>
                                Salvar como Imagem
                            </button>
                        </div>
                    </div>

                    <div class="results-grid">
                        <div class="result-item">
                            <span class="value" id="horas-mes">0</span>
                            <span class="label">Horas economizadas / Mês</span>
                            <p class="description">Total de horas de trabalho que sua equipe economiza todo mês.</p>
                        </div>
                        <div class="result-item">
                            <span class="value" id="horas-ano">0</span>
                            <span class="label">Horas economizadas / Ano</span>
                             <p class="description">Projeção anual da economia para atividades estratégicas.</p>
                        </div>
                        <div class="result-item">
                            <span class="value" id="servidores">0</span>
                            <span class="label">Servidores realocados</span>
                             <p class="description">Equivalente à força de trabalho liberada de tarefas repetitivas.</p>
                        </div>
                         <div class="result-item">
                            <span class="value" id="reducao-tempo">0%</span>
                            <span class="label">Redução no tempo de execução</span>
                             <p class="description">Percentual de redução no tempo médio para concluir as tarefas.</p>
                        </div>
                    </div>

                    <h3>Nova Capacidade de Atendimento</h3>
                    <p class="subtitle" style="font-size: 1rem;">Com o tempo economizado, sua equipe poderia realizar muito mais. Veja a nova capacidade produtiva mensal:</p>
                    <table class="capacity-table">
                        <thead>
                            <tr>
                                <th>Tarefa</th>
                                <th>Volume Mensal Atual</th>
                                <th>Nova Capacidade com IA</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Transcrição de Vídeos</td>
                                <td id="table-transcricoes-atual">0</td>
                                <td id="table-transcricoes-nova" class="new-capacity">0</td>
                            </tr>
                            <tr>
                                <td>Elaboração de Documentos</td>
                                <td id="table-documentos-atual">0</td>
                                <td id="table-documentos-nova" class="new-capacity">0</td>
                            </tr>
                            <tr>
                                <td>Pesquisa de Jurisprudência</td>
                                <td id="table-pesquisas-atual">0</td>
                                <td id="table-pesquisas-nova" class="new-capacity">0</td>
                            </tr>
                            <tr>
                                G<td>Atendimento ao Cidadão</td>
                                <td id="table-atendimentos-atual">0</td>
                                <td id="table-atendimentos-nova" class="new-capacity">∞</td>
                            </tr>
                        </tbody>
                    </table>

                </div>

                 <div class="rules-container">
                    <div class="rules-header-flex"> 
                        <button id="rules-toggle">
                            <span>Ver regras de cálculo</span>
                            <span class="material-symbols-outlined">expand_more</span>
                        </button>
                        
                        <button id="save-rules-png-btn" class="btn-export" style="display: none;">
                            <span class="material-symbols-outlined">image</span>
                            Salvar Regras
                        </button>
                    </div> 
                    <div id="rules-content">
                        <h4>1. PREMISSAS E CONSTANTES INTERNAS</h4>
                        <p>Os cálculos são baseados em médias de mercado e na eficiência das ferramentas Xertica.ai.</p>
                        <ul>
                            <li><b>TEMPOS MANUAIS (POR UNIDADE):</b> TRANSCRIÇÃO (240 MIN), DOCUMENTO (120 MIN), PESQUISA (60 MIN), ATENDIMENTO (15 MIN).</li>
                            <li><b>TEMPOS COM IA (POR UNIDADE):</b> TRANSCRIÇÃO (6 MIN), DOCUMENTO (5 MIN), PESQUISA (3 MIN), ATENDIMENTO (0 MIN, VIA CHATBOT).</li>
                             <li><b>CONSTANTES DE TRABALHO:</b> 252 DIAS ÚTEIS/ANO; 168 HORAS DE TRABALHO/SERVIDOR/MÊS.</li>
                        </ul>
                        <h4>2. CÁLCULOS DOS RESULTADOS PRINCIPAIS</h4>
                        <p><b>A. TOTAL DE TEMPO GASTO:</b> SOMAMOS O TEMPO DE TODAS AS TAREFAS INSERIDAS, COMPARANDO O CENÁRIO MANUAL COM O CENÁRIO DE IA.</p>
                        <p><b>B. HORAS ECONOMIZADAS (MÊS):</b> (TEMPO MANUAL TOTAL - TEMPO COM IA TOTAL) / 60.</p>
                        <p><b>C. HORAS ECONOMIZADAS (ANO):</b> HORAS ECONOMIZADAS (MÊS) * 12.</p>
                        <p><b>D. SERVIDORES REALOCADOS:</b> HORAS ECONOMIZADAS (ANO) / (8 HORAS/DIA * 252 DIAS/ANO). ESTE VALOR REPRESENTA O GANHO DE FORÇA DE TRABALHO PARA ATIVIDADES ESTRATÉGICAS.</p>
                        <p><b>E. REDUÇÃO NO TEMPO DE EXECUÇÃO (%):</b> (1 - (TEMPO COM IA TOTAL / TEMPO MANUAL TOTAL)) * 100.</p>
                        <h4>3. CÁLCULO DA TABELA "CAPACIDADE DE ATENDIMENTO"</h4>
                        <p>ESTA TABELA MOSTRA QUANTAS TAREFAS A MAIS SUA EQUIPE PODERIA FAZER NO MESMO TEMPO. PARA CADA TAREFA, A FÓRMULA É: (QTD. ATUAL * TEMPO MANUAL POR TAREFA) / TEMPO COM IA POR TAREFA.</p>
                    </div>
                </div>

                <!-- Disclaimer -->
                <div class="disclaimer-text">
                    <p>*Esta é uma simulação baseada no tempo médio gasto manualmente para a tarefa versus o tempo médio com IA, podendo variar conforme o caso de uso e a complexidade da tarefa.</p>
                </div>

            </div>
        </div>
    </main>

    <footer class="site-footer">
        <p>© 2024 Xertica.ai. Todos os direitos reservados.</p>
    </footer>

    <!-- Container off-screen for rendering PNG -->
    <div id="render-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const calculateBtn = document.getElementById('calculate-btn');
            const resultsSection = document.getElementById('results-section');
            const savePngBtn = document.getElementById('save-png-btn');
            const rulesToggle = document.getElementById('rules-toggle');
            const rulesContent = document.getElementById('rules-content');
            const saveRulesPngBtn = document.getElementById('save-rules-png-btn'); 

            // Definições de tempo
            const temposManuais = { transcricao: 240, documento: 120, pesquisa: 60, atendimento: 15 };
            const temposIA = { transcricao: 6, documento: 5, pesquisa: 3, atendimento: 0 };
            const diasUteisAno = 252;
            const horasTrabalhoDia = 8;

            calculateBtn.addEventListener('click', () => {
                // Obter valores
                const qtdTranscricoes = Number(document.getElementById('transcricoes').value) || 0;
                const qtdDocumentos = Number(document.getElementById('documentos').value) || 0;
                const qtdPesquisas = Number(document.getElementById('pesquisas').value) || 0;
                const qtdAtendimentos = Number(document.getElementById('atendimentos').value) || 0;
                const clientCompany = document.getElementById('client_company').value;

                // Calcular tempos
                const tempoManualTotal = (qtdTranscricoes * temposManuais.transcricao) + (qtdDocumentos * temposManuais.documento) + (qtdPesquisas * temposManuais.pesquisa) + (qtdAtendimentos * temposManuais.atendimento);
                const tempoIATotal = (qtdTranscricoes * temposIA.transcricao) + (qtdDocumentos * temposIA.documento) + (qtdPesquisas * temposIA.pesquisa) + (qtdAtendimentos * temposIA.atendimento);

                // Calcular métricas
                const minutosEconomizados = tempoManualTotal - tempoIATotal;
                const horasEconomizadasMes = minutosEconomizados / 60;
                const horasEconomizadasAno = horasEconomizadasMes * 12;
                const servidoresRealocados = horasEconomizadasAno / (horasTrabalhoDia * diasUteisAno);
                const reducaoTempo = tempoManualTotal > 0 ? (1 - (tempoIATotal / tempoManualTotal)) * 100 : 0;

                // Calcular nova capacidade
                const novaCapacidade = {
                    transcricoes: temposIA.transcricao > 0 ? (qtdTranscricoes * temposManuais.transcricao) / temposIA.transcricao : Infinity,
                    documentos: temposIA.documento > 0 ? (qtdDocumentos * temposManuais.documento) / temposIA.documento : Infinity,
                    pesquisas: temposIA.pesquisa > 0 ? (qtdPesquisas * temposManuais.pesquisa) / temposIA.pesquisa : Infinity,
                    atendimentos: temposIA.atendimento > 0 ? (qtdAtendimentos * temposManuais.atendimento) / temposIA.atendimento : Infinity,
                };
                
                // Funções de formatação
                const formatNumber = (num) => num.toLocaleString('pt-BR', { maximumFractionDigits: 1 });
                const formatInt = (num) => Math.floor(num).toLocaleString('pt-BR');

                // Atualizar UI - Resultados Principais
                document.getElementById('results-title').textContent = clientCompany ? `Relatório de Impacto para ${clientCompany}`.toUpperCase() : 'Relatório de Impacto com IA'.toUpperCase();
                document.getElementById('horas-mes').textContent = formatNumber(horasEconomizadasMes);
                document.getElementById('horas-ano').textContent = formatNumber(horasEconomizadasAno);
                document.getElementById('servidores').textContent = servidoresRealocados.toFixed(1).replace('.', ',');
                document.getElementById('reducao-tempo').textContent = `${formatInt(reducaoTempo)}%`;
                
                // Atualizar UI - Tabela
                document.getElementById('table-transcricoes-atual').textContent = formatInt(qtdTranscricoes);
                document.getElementById('table-transcricoes-nova').textContent = formatInt(novaCapacidade.transcricoes);
                document.getElementById('table-documentos-atual').textContent = formatInt(qtdDocumentos);
                document.getElementById('table-documentos-nova').textContent = formatInt(novaCapacidade.documentos);
                document.getElementById('table-pesquisas-atual').textContent = formatInt(qtdPesquisas);
                document.getElementById('table-pesquisas-nova').textContent = formatInt(novaCapacidade.pesquisas);
                document.getElementById('table-atendimentos-atual').textContent = formatInt(qtdAtendimentos);
                document.getElementById('table-atendimentos-nova').textContent = (novaCapacidade.atendimentos === Infinity) ? '∞ (AUTÔNOMO)' : formatInt(novaCapacidade.atendimentos);

                // Mostrar resultados
                resultsSection.style.display = 'block';
                setTimeout(() => {
                    resultsSection.style.opacity = '1';
                    resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 10);
            });
            
            // Função para gerar o HTML do relatório para PNG
            function generateReportHTML() {
                const clientName = document.getElementById('client_name').value || 'Cliente';
                const clientCompany = document.getElementById('client_company').value || 'Empresa';
                const sellerName = document.getElementById('seller_name').value || 'Consultor Xertica.ai';
                const reportDate = new Date().toLocaleDateString('pt-BR');
                
                const resultsClone = document.getElementById('results-section').cloneNode(true);
                resultsClone.querySelector('.export-buttons').remove();

                const reportHTML = `
                    <div style="padding: 40px; font-family: 'Roboto', sans-serif; color: #393232; width: 8.5in; background: white;">
                         <style>
                            h1, h2, h3 { font-family: 'Space Mono', monospace; text-transform: uppercase; color: #1E1E1E; }
                            .results-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
                            .result-item { background-color: #F6F8FA; padding: 15px; border-radius: 8px; }
                            .result-item .value { font-family: 'Space Mono', monospace; font-size: 32px; font-weight: 700; background: linear-gradient(90deg, #FF00F3, #00C0FF); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
                            .result-item .label { font-size: 10px; font-weight: 700; text-transform: uppercase; }
                            .result-item .description { font-size: 11px; color: #393232; margin-top: 5px; }
                            .capacity-table { width: 100%; border-collapse: collapse; font-size: 12px; }
                            .capacity-table th, .capacity-table td { padding: 10px; border-bottom: 1px solid #E6E8EB; text-align: left;}
                            .capacity-table thead tr { background-color: #1E1E1E; color: white; font-family: 'Space Mono', monospace; }
                            .new-capacity { color: #00C0FF; font-weight: 700; }
                         </style>
                        <div style="text-align: center; margin-bottom: 30px;">
                            <img src="https://cdn.prod.website-files.com/653ff55cffa885d43e1a7bfa/6672e8383dbaa6bd3e8e527c_logo-xerticaAi.png" alt="Logo Xertica.ai" style="height: 30px;" crossorigin="anonymous">
                        </div>
                        <div style="text-align: center; border-bottom: 1px solid #E6E8EB; padding-bottom: 20px; margin-bottom: 20px;">
                            <h1 style="font-size: 20px; margin: 0 0 8px 0;">RELATÓRIO DE IMPACTO DE IA</h1>
                            <p style="font-size: 14px; margin: 0;">Preparado para: <strong>${clientName} (${clientCompany})</strong></p>
                            <p style="font-size: 12px; margin: 4px 0 0 0;">Consultor: ${sellerName} | Data: ${reportDate}</p>
                        </div>
                        <div>
                            ${resultsClone.innerHTML}
                        </div>
                        
                        <!-- Disclaimer no PNG -->
                        <div style="font-size: 10px; color: #393232; margin-top: 20px; border-top: 1px solid #E6E8EB; padding-top: 15px; text-align: left; line-height: 1.5;">
                            <p>*Esta é uma simulação baseada no tempo médio gasto manually para a tarefa versus o tempo médio com IA, podendo variar conforme o caso de uso e a complexidade da tarefa.</p>
                        </div>
                    </div>
                `;
                return reportHTML;
            }
            
            // Salvar Relatório como PNG
            savePngBtn.addEventListener('click', () => {
                if (resultsSection.style.display === 'none') { console.warn('Gere um relatório antes de salvar.'); return; }
                const clientCompany = document.getElementById('client_company').value || 'xertica';
                const renderContainer = document.getElementById('render-container');
                renderContainer.innerHTML = generateReportHTML();
                
                const elementToCapture = renderContainer.firstElementChild;
                
                html2canvas(elementToCapture, { scale: 3, useCORS: true }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = `relatorio_impacto_ia_${clientCompany.replace(/\s+/g, '_')}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                });
            });

            // Função para gerar HTML das Regras para PNG
            function generateRulesHTML() {
                const rulesClone = document.getElementById('rules-content').cloneNode(true);
                rulesClone.style.padding = '0'; 
                rulesClone.style.marginTop = '0';
                
                const reportHTML = `
                    <div style="padding: 40px; font-family: 'Roboto', sans-serif; color: #393232; width: 8.5in; background: white; text-align: left;">
                         <style>
                            h4 { font-family: 'Space Mono', monospace; font-size: 1rem; margin-top: 1.5rem; margin-bottom: 0.5rem; color: #1E1E1E; text-transform: uppercase; }
                            p { font-size: 0.9rem; line-height: 1.8; margin: 0.5rem 0; }
                            ul { list-style-position: inside; padding-left: 0; font-size: 0.9rem; line-height: 1.8; }
                            li { margin-bottom: 0.5rem; }
                         </style>
                        <div style="text-align: center; margin-bottom: 30px;">
                            <img src="https://cdn.prod.website-files.com/653ff55cffa885d43e1a7bfa/6672e8383dbaa6bd3e8e527c_logo-xerticaAi.png" alt="Logo Xertica.ai" style="height: 30px;" crossorigin="anonymous">
                            <h2 style="font-family: 'Space Mono', monospace; text-transform: uppercase; color: #1E1E1E; font-size: 20px; margin: 20px 0 0 0;">Regras de Cálculo da Simulação</h2>
                        </div>
                        <div>
                            ${rulesClone.innerHTML}
                        </div>
                         
                        <!-- Disclaimer no PNG -->
                        <div style="font-size: 10px; color: #393232; margin-top: 20px; border-top: 1px solid #E6E8EB; padding-top: 15px; text-align: left; line-height: 1.5;">
                            <p>*Esta é uma simulação baseada no tempo médio gasto manualmente para a tarefa versus o tempo médio com IA, podendo variar conforme o caso de uso e a complexidade da tarefa.</p>
                        </div>
                    </div>
                `;
                return reportHTML;
            }

            // Salvar Regras como PNG
            saveRulesPngBtn.addEventListener('click', () => {
                const renderContainer = document.getElementById('render-container');
                renderContainer.innerHTML = generateRulesHTML();
                
                const elementToCapture = renderContainer.firstElementChild;
                
                html2canvas(elementToCapture, { scale: 3, useCORS: true }).then(canvas => {
                    const link = document.createElement('a');
                    link.download = `regras_calculo_impacto_ia.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                });
            });

            // Toggle das Regras
            rulesToggle.addEventListener('click', () => {
                rulesContent.classList.toggle('visible');
                const icon = rulesToggle.querySelector('.material-symbols-outlined');
                const isVisible = rulesContent.classList.contains('visible');
                icon.textContent = isVisible ? 'expand_less' : 'expand_more';
                icon.style.transform = isVisible ? 'rotate(180deg)' : 'rotate(0deg)';
                rulesToggle.querySelector('span').textContent = isVisible ? 'OCULTAR REGRAS DE CÁLCULO' : 'VER REGRAS DE CÁLCULO';
                saveRulesPngBtn.style.display = isVisible ? 'inline-flex' : 'none'; 
            });
        });
    </script>
</body>
</html>

